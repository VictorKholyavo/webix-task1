<!DOCTYPE HTML>
<html>
    <head>
    <link rel="stylesheet" href="http://cdn.webix.com/edge/webix.css" type="text/css">
    <link rel="stylesheet" href="style.css" type="text/css">
    <script src="http://cdn.webix.com/edge/webix.js" type="text/javascript"></script>
    <script src="testdata.js" type="text/javascript" charset="utf-8"></script>
    </head>
    <body>
        <script type="text/javascript" charset="utf-8">
              var header = {
                  view: "toolbar",
                  css: "webix_header webix_dark",
                  cols:[
                        {
                          view:"label",
                          label:"My App"
                        },
                        {
                          view:"button",
                          id:"mybutton",
                          type:"icon",
                          icon:"wxi-user",
                          width: 100,
                          label:"Profile",
                          value:"Show window",
                          popup:"my_pop"
                        },
                    ]
              };

              var main = {
                  rows:[
                      { cols: [
                        {
                          css: "list",
                          rows: [
                            {
                              css: "list",
                              view: "list",
                              borderless:true,
                              id:"mylist",
                              scroll:false,
                              width:200,
                              data:[ "Dashboard", "Users", "Products", "Locations" ],
                            },
                            {
                              view: "label",
                              autoheight: true,
                              css: "centered status",
                              label:"<span class='webix_icon wxi-check'></span>Connected"
                            }
                          ]
                        },
                        { view:"resizer" },
                        {
                          view:"datatable",
                          id:"mydatatable",
                          scrollX: false,
                          autoConfig:true,
                          data: small_film_set
                        },
                        {
                          view:"form",
                          id: "myform",
                          width: 400,
                          autoheight: false,
                          elements:[
                              { template:"Edit films", type:"section"},
                              { view:"text", label:"Title", name:"title", invalidMessage:"Title must be filled in" },
                              { view:"text", label:"Year", name:"year", invalidMessage:"Year should be between 1970 and 2019" },
                              { view:"text", label:"Rating", name:"rating", invalidMessage:"Rating must be number, not a 0 and not empty" },
                              { view:"text", label:"Votes", name:"votes", invalidMessage:"Votes must be less than 100000" },
                              { margin: 20,
                                cols:[
                                  { view:"button",
                                    value:"Add new",
                                    type:"form",
                                    click:function(){
                                      if($$("myform").validate()){
                                          var item = $$("myform").getValues();
                                          $$("mydatatable").add(item);
                                          webix.message("Correct data");
                                      }
                                    }
                                  },
                                  {
                                    view:"button",
                                    value:"Clear",
                                    click:function(){
                                      webix.confirm({
                                        title:"Clear?",
                                        ok:"Yes",
                                        cancel:"No",
                                        text:"Clear",
                                        callback:function(result) {
                                          if (result) {
                                            for (var key in $$("myform").elements) {
                                                $$("myform").elements[key].setValue("");
                                            }
                                            $$("myform").clearValidation();
                                          }
                                          else {
                                            return
                                          }
                                        }
                                      })
                                    }
                                  }
                              ]}
                          ],
                          rules:{
                              title:webix.rules.isNotEmpty,
                              year:function(value){
                                return value>1970 && value<=2019;
                              },
                              votes:function(value){
                                return value<100000;
                              },
                              rating:function(value){
                                  if (!webix.rules.isNotEmpty(value) ) return false;
                                  if (value == 0) return false;
                                  if (isNaN(value)) return false;
                                  return true;
                              }
                          },
                          on:{
                             onValidationError:function(key, data){
                               webix.message({text:key+" field is incorrect", type:"error"});
                             }
                          }
                      }
                  ]
              }
            ]};

              var footer = {
                rows:[
                  {
                    view: "template",
                    css: "centered",
                    height: 40,
                    template:"The software is provided by <span><a href='https://webix.com'>https://webix.com</a></span>. All rights reserved (c)"
                  }
                ]
              };



              webix.ui({
                 id:"app",
                 rows:[header, main, footer]
              });

              webix.ui({
                view:"popup",
              	id:"my_pop",
                  head:"Submenu",
              	width:200,
              	body:{
              		view:"list",
              		data:[
                      {id:"1", name:"Settings"},
              				{id:"2", name:"Log Out"},
              		],
              		datatype:"json",
              		template:"#name#",
              		autoheight:true,
              		select:true
                }
              });

        </script>
    </body>
</html>
